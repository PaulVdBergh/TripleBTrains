\hypertarget{classTBT_1_1Manager}{}\section{T\+BT\+:\+:Manager Class Reference}
\label{classTBT_1_1Manager}\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}


Class \hyperlink{classTBT_1_1Manager}{Manager} represents \textquotesingle{}the Boss\textquotesingle{} in the system.  




{\ttfamily \#include $<$Manager.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classTBT_1_1Manager_a9e6016c4b93e9fff6338c5413d1a1f78_a9e6016c4b93e9fff6338c5413d1a1f78}{Manager} ()
\begin{DoxyCompactList}\small\item\em class \hyperlink{classTBT_1_1Manager}{Manager} constructor \end{DoxyCompactList}\item 
virtual \hyperlink{classTBT_1_1Manager_a431bd969c21eec974597b15d2208f19f_a431bd969c21eec974597b15d2208f19f}{$\sim$\+Manager} ()
\begin{DoxyCompactList}\small\item\em class \hyperlink{classTBT_1_1Manager}{Manager} destructor \end{DoxyCompactList}\item 
\hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$ \hyperlink{classTBT_1_1Manager_a04d5ae5069f1f17ee682f4ae68141687_a04d5ae5069f1f17ee682f4ae68141687}{find\+Decoder} (uint16\+\_\+t dcc\+Address)
\begin{DoxyCompactList}\small\item\em returns pointer to decoder with address dcc\+Address or N\+U\+LL if decoder doesn\textquotesingle{}t exists. \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_a7b20f8a47d78cfd39649722a9fba2f7c_a7b20f8a47d78cfd39649722a9fba2f7c}{register\+Decoder} (\hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$p\+Decoder)
\begin{DoxyCompactList}\small\item\em registers (add) the decoder into the pool of decoders \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_a507ac74f4adfbb6173728bebe71e40e6_a507ac74f4adfbb6173728bebe71e40e6}{unregister\+Decoder} (\hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$p\+Decoder)
\begin{DoxyCompactList}\small\item\em unregisters (remove) the decoder from the pool of decoders \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_aaac6dc1a57d9c578a3da2243584a8a22_aaac6dc1a57d9c578a3da2243584a8a22}{broadcast\+Loc\+Info\+Changed} (\hyperlink{classTBT_1_1LocDecoder}{Loc\+Decoder} $\ast$p\+Loc)
\begin{DoxyCompactList}\small\item\em sends message to all interfaces about the locdecoder \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_a6e7616a839a1b48d89355bc740ed7793_a6e7616a839a1b48d89355bc740ed7793}{set\+Power\+State} (\hyperlink{namespaceTBT_a05cc33b74a68fb6eaf5962b5979716d4_a05cc33b74a68fb6eaf5962b5979716d4}{Power\+State} new\+State)
\begin{DoxyCompactList}\small\item\em sets the new powerstate and notifies all interfaces about the new state \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_a5f5fdba7ccae731f3f348b572fd0ed16_a5f5fdba7ccae731f3f348b572fd0ed16}{set\+Emergency\+Stop} ()
\begin{DoxyCompactList}\small\item\em sets the emergency stop flag and notifies all interfaces about the new state \end{DoxyCompactList}\item 
void \hyperlink{classTBT_1_1Manager_a007018b4e6441c9af63cb72f1ffc8a19_a007018b4e6441c9af63cb72f1ffc8a19}{get\+System\+State} (\hyperlink{structTBT_1_1SystemState}{System\+State} $\ast$p\+Msg)
\begin{DoxyCompactList}\small\item\em copies the systemstate into p\+Msg \end{DoxyCompactList}\item 
const uint8\+\_\+t \& \hyperlink{classTBT_1_1Manager_a78e5bea49f6662b5f44c1c0aafe4cb75_a78e5bea49f6662b5f44c1c0aafe4cb75}{get\+Central\+State} (void)
\begin{DoxyCompactList}\small\item\em returns reference to the central\+State of the unit \end{DoxyCompactList}\item 
const uint8\+\_\+t \& \hyperlink{classTBT_1_1Manager_ac080a9e6746a43453d26ea43fd046c14_ac080a9e6746a43453d26ea43fd046c14}{get\+Central\+State\+Ex} (void)
\begin{DoxyCompactList}\small\item\em returns reference to the central\+State\+Ex of the unit \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structTBT_1_1SystemState}{System\+State} \hyperlink{classTBT_1_1Manager_a21b7ad1a3360959eb90df2965c1d38ea_a21b7ad1a3360959eb90df2965c1d38ea}{m\+\_\+\+System\+State}
\begin{DoxyCompactList}\small\item\em variable to hold the systemstate of the unit \end{DoxyCompactList}\item 
recursive\+\_\+mutex \hyperlink{classTBT_1_1Manager_a7d8f3b83e123244f27ed4d75421ab016_a7d8f3b83e123244f27ed4d75421ab016}{m\+\_\+\+M\+System\+State}
\begin{DoxyCompactList}\small\item\em mutex to protect m\+\_\+\+System\+State against concurrent access \end{DoxyCompactList}\item 
vector$<$ \hyperlink{classTBT_1_1ClientInterface}{Client\+Interface} $\ast$ $>$ \hyperlink{classTBT_1_1Manager_a891445980d26bff2cb101a96ffadb36d_a891445980d26bff2cb101a96ffadb36d}{m\+\_\+\+Client\+Interfaces}
\begin{DoxyCompactList}\small\item\em all the active clientinterfaces \end{DoxyCompactList}\item 
recursive\+\_\+mutex \hyperlink{classTBT_1_1Manager_a07202ce2904cf24a4b5127ff12d54834_a07202ce2904cf24a4b5127ff12d54834}{m\+\_\+\+M\+Client\+Interfaces}
\begin{DoxyCompactList}\small\item\em mutex to protect m\+\_\+\+Client\+Interfaces against concurrent access \end{DoxyCompactList}\item 
map$<$ uint16\+\_\+t, \hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$ $>$ \hyperlink{classTBT_1_1Manager_a37238f0b1b6d04d9a405f66f560c8d1a_a37238f0b1b6d04d9a405f66f560c8d1a}{m\+\_\+\+Decoders}
\begin{DoxyCompactList}\small\item\em all the decoders in the system, indexed by D\+CC address \end{DoxyCompactList}\item 
recursive\+\_\+mutex \hyperlink{classTBT_1_1Manager_a784fe0e0a20a0c7d0832186abe245f78_a784fe0e0a20a0c7d0832186abe245f78}{m\+\_\+\+M\+Decoders}
\begin{DoxyCompactList}\small\item\em mutex to protect m\+\_\+\+Decoders against concurrent access \end{DoxyCompactList}\item 
\hyperlink{classTBT_1_1DccGenerator}{Dcc\+Generator} $\ast$ \hyperlink{classTBT_1_1Manager_ad070372930d6b26a933f9a087666beff_ad070372930d6b26a933f9a087666beff}{m\+\_\+p\+Dcc\+Generator}
\begin{DoxyCompactList}\small\item\em pointer to the D\+CC generator \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Class \hyperlink{classTBT_1_1Manager}{Manager} represents \textquotesingle{}the Boss\textquotesingle{} in the system. 

Class \hyperlink{classTBT_1_1Manager}{Manager} is responsible for general supervision over the correct distribution of the different events through the whole system. It collects and keeps state information regarding the overall state of the system. 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classTBT_1_1Manager_a9e6016c4b93e9fff6338c5413d1a1f78_a9e6016c4b93e9fff6338c5413d1a1f78}\label{classTBT_1_1Manager_a9e6016c4b93e9fff6338c5413d1a1f78_a9e6016c4b93e9fff6338c5413d1a1f78}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!Manager@{Manager}}
\index{Manager@{Manager}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{Manager()}{Manager()}}
{\footnotesize\ttfamily T\+B\+T\+::\+Manager\+::\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



class \hyperlink{classTBT_1_1Manager}{Manager} constructor 

Default constructor for class \hyperlink{classTBT_1_1Manager}{Manager}.

Create a new \hyperlink{classTBT_1_1Manager}{Manager} instance with the following interfaces\+:


\begin{DoxyItemize}
\item \hyperlink{classTBT_1_1UDPClientInterface}{U\+D\+P\+Client\+Interface}
\item \hyperlink{classTBT_1_1XpressNetClientInterface}{Xpress\+Net\+Client\+Interface}
\item \hyperlink{classTBT_1_1WSClientInterface}{W\+S\+Client\+Interface}
\end{DoxyItemize}

then, create and start a \hyperlink{classTBT_1_1DccGenerator}{Dcc\+Generator}


\begin{DoxyParams}{Parameters}
{\em none} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
none, a new \hyperlink{classTBT_1_1Manager}{Manager} instance is created
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
It is quite obvious that there should be just one and only one instance of this class in the running application. Maybe I implement it as a singleton, don\textquotesingle{}t know for now... 
\end{DoxyWarning}


References m\+\_\+\+Client\+Interfaces, m\+\_\+\+Decoders, m\+\_\+\+M\+Decoders, and m\+\_\+p\+Dcc\+Generator.

\mbox{\Hypertarget{classTBT_1_1Manager_a431bd969c21eec974597b15d2208f19f_a431bd969c21eec974597b15d2208f19f}\label{classTBT_1_1Manager_a431bd969c21eec974597b15d2208f19f_a431bd969c21eec974597b15d2208f19f}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!````~Manager@{$\sim$\+Manager}}
\index{````~Manager@{$\sim$\+Manager}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{$\sim$\+Manager()}{~Manager()}}
{\footnotesize\ttfamily T\+B\+T\+::\+Manager\+::$\sim$\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



class \hyperlink{classTBT_1_1Manager}{Manager} destructor 

Destructor for class \hyperlink{classTBT_1_1Manager}{Manager}

Destroy the instance by first deleting the \hyperlink{classTBT_1_1DccGenerator}{Dcc\+Generator} and then deleting all client\+Interfaces.


\begin{DoxyParams}{Parameters}
{\em none} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
none, the \hyperlink{classTBT_1_1Manager}{Manager} instance is deleted. 
\end{DoxyReturn}


References m\+\_\+\+Client\+Interfaces, and m\+\_\+p\+Dcc\+Generator.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classTBT_1_1Manager_aaac6dc1a57d9c578a3da2243584a8a22_aaac6dc1a57d9c578a3da2243584a8a22}\label{classTBT_1_1Manager_aaac6dc1a57d9c578a3da2243584a8a22_aaac6dc1a57d9c578a3da2243584a8a22}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!broadcast\+Loc\+Info\+Changed@{broadcast\+Loc\+Info\+Changed}}
\index{broadcast\+Loc\+Info\+Changed@{broadcast\+Loc\+Info\+Changed}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{broadcast\+Loc\+Info\+Changed()}{broadcastLocInfoChanged()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::broadcast\+Loc\+Info\+Changed (\begin{DoxyParamCaption}\item[{\hyperlink{classTBT_1_1LocDecoder}{Loc\+Decoder} $\ast$}]{p\+Loc }\end{DoxyParamCaption})}



sends message to all interfaces about the locdecoder 

\hyperlink{classTBT_1_1Manager_aaac6dc1a57d9c578a3da2243584a8a22_aaac6dc1a57d9c578a3da2243584a8a22}{Manager\+::broadcast\+Loc\+Info\+Changed} itterates over the pool of interfaces and informs each of them about the change in the state of \hyperlink{classTBT_1_1LocDecoder}{Loc\+Decoder} pointed to by p\+Loc.


\begin{DoxyParams}{Parameters}
{\em p\+Loc} & pointer to \hyperlink{classTBT_1_1LocDecoder}{Loc\+Decoder} who\textquotesingle{}s state changed.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References m\+\_\+\+Client\+Interfaces, and m\+\_\+\+M\+Client\+Interfaces.



Referenced by T\+B\+T\+::\+Loc\+Decoder\+::set\+Busy(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Direction(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Dual\+Traction(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F0(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F1(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F10(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F11(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F12(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F13(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F14(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F15(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F16(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F17(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F18(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F19(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F2(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F20(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F21(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F22(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F23(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F24(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F25(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F26(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F27(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F28(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F3(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F4(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F5(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F6(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F7(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F8(), T\+B\+T\+::\+Loc\+Decoder\+::set\+F9(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Function\+Group1(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Function\+Group2(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Function\+Group3(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Function\+Group4(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Function\+Group5(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Light(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Loco\+Drive128(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Loco\+Drive14(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Loco\+Drive27(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Loco\+Drive28(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Smart\+Search(), T\+B\+T\+::\+Loc\+Decoder\+::set\+Speed(), and T\+B\+T\+::\+Loc\+Decoder\+::set\+Speedsteps().

\mbox{\Hypertarget{classTBT_1_1Manager_a04d5ae5069f1f17ee682f4ae68141687_a04d5ae5069f1f17ee682f4ae68141687}\label{classTBT_1_1Manager_a04d5ae5069f1f17ee682f4ae68141687_a04d5ae5069f1f17ee682f4ae68141687}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!find\+Decoder@{find\+Decoder}}
\index{find\+Decoder@{find\+Decoder}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{find\+Decoder()}{findDecoder()}}
{\footnotesize\ttfamily \hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$ T\+B\+T\+::\+Manager\+::find\+Decoder (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{dcc\+Address }\end{DoxyParamCaption})}



returns pointer to decoder with address dcc\+Address or N\+U\+LL if decoder doesn\textquotesingle{}t exists. 

\hyperlink{classTBT_1_1Manager_a04d5ae5069f1f17ee682f4ae68141687_a04d5ae5069f1f17ee682f4ae68141687}{Manager\+::find\+Decoder} returns a pointer to the registered decoder with the specified D\+CC address. If the decoder isn\textquotesingle{}t found, return N\+U\+LL.

At this point we cannot create a new decoder instance because there is no way to determine what kind of decoder to create. (class \hyperlink{classTBT_1_1Decoder}{Decoder} is virtual)


\begin{DoxyParams}{Parameters}
{\em dcc\+Address} & the D\+CC address of the decoder to find\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to the decoder or N\+U\+LL if the decoder doesn\textquotesingle{}t appear in the list of registered decoders. 
\end{DoxyReturn}


References m\+\_\+\+Decoders, and m\+\_\+\+M\+Decoders.



Referenced by T\+B\+T\+::\+Xpress\+Net\+Client\+Interface\+::thread\+Func(), and T\+B\+T\+::\+U\+D\+P\+Client\+Interface\+::thread\+Func().

\mbox{\Hypertarget{classTBT_1_1Manager_a78e5bea49f6662b5f44c1c0aafe4cb75_a78e5bea49f6662b5f44c1c0aafe4cb75}\label{classTBT_1_1Manager_a78e5bea49f6662b5f44c1c0aafe4cb75_a78e5bea49f6662b5f44c1c0aafe4cb75}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!get\+Central\+State@{get\+Central\+State}}
\index{get\+Central\+State@{get\+Central\+State}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{get\+Central\+State()}{getCentralState()}}
{\footnotesize\ttfamily const uint8\+\_\+t\& T\+B\+T\+::\+Manager\+::get\+Central\+State (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



returns reference to the central\+State of the unit 


\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{8}{|X[-1]}|}
\caption{Central\+State layout}\label{_}\\
\hline
\rowcolor{\tableheadbgcolor}\textbf{ bit 7}&\textbf{ bit 6}&\textbf{ bit 5}&\textbf{ bit 4}&\textbf{ bit 3}&\textbf{ bit 2}&\textbf{ bit 1}&\textbf{ bit 0 }\\\cline{1-8}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ bit 7}&\textbf{ bit 6}&\textbf{ bit 5}&\textbf{ bit 4}&\textbf{ bit 3}&\textbf{ bit 2}&\textbf{ bit 1}&\textbf{ bit 0 }\\\cline{1-8}
\endhead
-\/&-\/&cs\+Programming\+Mode\+Active&-\/&-\/&cs\+Short\+Circuit&cd\+Track\+Voltage\+Off&cs\+Emergency\+Stop \\\cline{1-8}
\end{longtabu}


Referenced by T\+B\+T\+::\+Xpress\+Net\+Client\+Interface\+::thread\+Func(), and T\+B\+T\+::\+U\+D\+P\+Client\+Interface\+::thread\+Func().

\mbox{\Hypertarget{classTBT_1_1Manager_ac080a9e6746a43453d26ea43fd046c14_ac080a9e6746a43453d26ea43fd046c14}\label{classTBT_1_1Manager_ac080a9e6746a43453d26ea43fd046c14_ac080a9e6746a43453d26ea43fd046c14}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!get\+Central\+State\+Ex@{get\+Central\+State\+Ex}}
\index{get\+Central\+State\+Ex@{get\+Central\+State\+Ex}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{get\+Central\+State\+Ex()}{getCentralStateEx()}}
{\footnotesize\ttfamily const uint8\+\_\+t\& T\+B\+T\+::\+Manager\+::get\+Central\+State\+Ex (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



returns reference to the central\+State\+Ex of the unit 


\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{8}{|X[-1]}|}
\caption{Central\+State\+Ex layout}\label{_}\\
\hline
\rowcolor{\tableheadbgcolor}\textbf{ bit 7}&\textbf{ bit 6}&\textbf{ bit 5}&\textbf{ bit 4}&\textbf{ bit 3}&\textbf{ bit 2}&\textbf{ bit 1}&\textbf{ bit 0 }\\\cline{1-8}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ bit 7}&\textbf{ bit 6}&\textbf{ bit 5}&\textbf{ bit 4}&\textbf{ bit 3}&\textbf{ bit 2}&\textbf{ bit 1}&\textbf{ bit 0 }\\\cline{1-8}
\endhead
-\/&-\/&-\/&-\/&cse\+Short\+Circuit\+Internal&cse\+Short\+Circuit\+External&cse\+Power\+Lost&cse\+High\+Temperature \\\cline{1-8}
\end{longtabu}
\mbox{\Hypertarget{classTBT_1_1Manager_a007018b4e6441c9af63cb72f1ffc8a19_a007018b4e6441c9af63cb72f1ffc8a19}\label{classTBT_1_1Manager_a007018b4e6441c9af63cb72f1ffc8a19_a007018b4e6441c9af63cb72f1ffc8a19}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!get\+System\+State@{get\+System\+State}}
\index{get\+System\+State@{get\+System\+State}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{get\+System\+State()}{getSystemState()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::get\+System\+State (\begin{DoxyParamCaption}\item[{\hyperlink{structTBT_1_1SystemState}{System\+State} $\ast$}]{p\+Msg }\end{DoxyParamCaption})}



copies the systemstate into p\+Msg 

\hyperlink{classTBT_1_1Manager_a007018b4e6441c9af63cb72f1ffc8a19_a007018b4e6441c9af63cb72f1ffc8a19}{Manager\+::get\+System\+State} generate the U\+DP message (Z21 L\+AN protocol) about the unit\textquotesingle{}s systemstate. The user is responsible for allocating a buffer big enough to contain the returned message.


\begin{DoxyParams}{Parameters}
{\em p\+Msg} & \+: pointer to a struct \hyperlink{structTBT_1_1SystemState}{System\+State} variable.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References T\+B\+T\+::\+System\+State\+::\+Data\+Len, m\+\_\+\+M\+System\+State, and m\+\_\+\+System\+State.



Referenced by T\+B\+T\+::\+Loc\+Decoder\+::get\+Dcc\+Message(), and T\+B\+T\+::\+U\+D\+P\+Client\+Interface\+::thread\+Func().

\mbox{\Hypertarget{classTBT_1_1Manager_a7b20f8a47d78cfd39649722a9fba2f7c_a7b20f8a47d78cfd39649722a9fba2f7c}\label{classTBT_1_1Manager_a7b20f8a47d78cfd39649722a9fba2f7c_a7b20f8a47d78cfd39649722a9fba2f7c}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!register\+Decoder@{register\+Decoder}}
\index{register\+Decoder@{register\+Decoder}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{register\+Decoder()}{registerDecoder()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::register\+Decoder (\begin{DoxyParamCaption}\item[{\hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$}]{p\+Decoder }\end{DoxyParamCaption})}



registers (add) the decoder into the pool of decoders 

\hyperlink{classTBT_1_1Manager_a7b20f8a47d78cfd39649722a9fba2f7c_a7b20f8a47d78cfd39649722a9fba2f7c}{Manager\+::register\+Decoder} registers (add) the decoder pointed to by p\+Decoder into the pool of decoders. If there already exists a decoder with the same address in the pool, the existing pointer will be overwritten. \begin{DoxyWarning}{Warning}
This situation can lead to a memoryleak.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em p\+Decoder} & pointer to the decoder to add into the pool\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References T\+B\+T\+::\+Decoder\+::get\+D\+C\+C\+Address(), m\+\_\+\+Decoders, and m\+\_\+\+M\+Decoders.



Referenced by T\+B\+T\+::\+Decoder\+::\+Decoder().

\mbox{\Hypertarget{classTBT_1_1Manager_a5f5fdba7ccae731f3f348b572fd0ed16_a5f5fdba7ccae731f3f348b572fd0ed16}\label{classTBT_1_1Manager_a5f5fdba7ccae731f3f348b572fd0ed16_a5f5fdba7ccae731f3f348b572fd0ed16}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!set\+Emergency\+Stop@{set\+Emergency\+Stop}}
\index{set\+Emergency\+Stop@{set\+Emergency\+Stop}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{set\+Emergency\+Stop()}{setEmergencyStop()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::set\+Emergency\+Stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



sets the emergency stop flag and notifies all interfaces about the new state 

\hyperlink{classTBT_1_1Manager_a5f5fdba7ccae731f3f348b572fd0ed16_a5f5fdba7ccae731f3f348b572fd0ed16}{Manager\+::set\+Emergency\+Stop} raises an emergencystop condition. All locdecoders shall be stopped immediatly but the power will remain on the tracks.


\begin{DoxyParams}{Parameters}
{\em none} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References T\+B\+T\+::\+System\+State\+::\+Central\+State, cs\+Emergency\+Stop, m\+\_\+\+Client\+Interfaces, m\+\_\+\+M\+Client\+Interfaces, m\+\_\+\+M\+System\+State, and m\+\_\+\+System\+State.



Referenced by T\+B\+T\+::\+Xpress\+Net\+Client\+Interface\+::thread\+Func(), and T\+B\+T\+::\+U\+D\+P\+Client\+Interface\+::thread\+Func().

\mbox{\Hypertarget{classTBT_1_1Manager_a6e7616a839a1b48d89355bc740ed7793_a6e7616a839a1b48d89355bc740ed7793}\label{classTBT_1_1Manager_a6e7616a839a1b48d89355bc740ed7793_a6e7616a839a1b48d89355bc740ed7793}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!set\+Power\+State@{set\+Power\+State}}
\index{set\+Power\+State@{set\+Power\+State}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{set\+Power\+State()}{setPowerState()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::set\+Power\+State (\begin{DoxyParamCaption}\item[{\hyperlink{namespaceTBT_a05cc33b74a68fb6eaf5962b5979716d4_a05cc33b74a68fb6eaf5962b5979716d4}{Power\+State}}]{new\+State }\end{DoxyParamCaption})}



sets the new powerstate and notifies all interfaces about the new state 

\hyperlink{classTBT_1_1Manager_a6e7616a839a1b48d89355bc740ed7793_a6e7616a839a1b48d89355bc740ed7793}{Manager\+::set\+Power\+State} set the powerstate of the system to the new state indicated by new\+State and informs each interface about the new state. In the case that new\+State is Power\+On, this function will cancel any pending emergencystop.


\begin{DoxyParams}{Parameters}
{\em new\+State} & member of enum Power\+State\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References T\+B\+T\+::\+System\+State\+::\+Central\+State, cs\+Emergency\+Stop, cs\+Track\+Voltage\+Off, m\+\_\+\+Client\+Interfaces, m\+\_\+\+M\+Client\+Interfaces, m\+\_\+\+M\+System\+State, m\+\_\+\+System\+State, and T\+B\+T\+::\+Power\+On.



Referenced by T\+B\+T\+::\+Xpress\+Net\+Client\+Interface\+::thread\+Func(), and T\+B\+T\+::\+U\+D\+P\+Client\+Interface\+::thread\+Func().

\mbox{\Hypertarget{classTBT_1_1Manager_a507ac74f4adfbb6173728bebe71e40e6_a507ac74f4adfbb6173728bebe71e40e6}\label{classTBT_1_1Manager_a507ac74f4adfbb6173728bebe71e40e6_a507ac74f4adfbb6173728bebe71e40e6}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!unregister\+Decoder@{unregister\+Decoder}}
\index{unregister\+Decoder@{unregister\+Decoder}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{unregister\+Decoder()}{unregisterDecoder()}}
{\footnotesize\ttfamily void T\+B\+T\+::\+Manager\+::unregister\+Decoder (\begin{DoxyParamCaption}\item[{\hyperlink{classTBT_1_1Decoder}{Decoder} $\ast$}]{p\+Decoder }\end{DoxyParamCaption})}



unregisters (remove) the decoder from the pool of decoders 

\hyperlink{classTBT_1_1Manager_a507ac74f4adfbb6173728bebe71e40e6_a507ac74f4adfbb6173728bebe71e40e6}{Manager\+::unregister\+Decoder} unregisters (remove) the decoder pointed to by p\+Decoder from the pool of decoders. If the decoder wasn\textquotesingle{}t prevoiusly registerd, i.\+e. it isn\textquotesingle{}t in the pool, nothing changes.


\begin{DoxyParams}{Parameters}
{\em p\+Decoder} & pointer to the decoder to remove from the pool\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


References T\+B\+T\+::\+Decoder\+::get\+D\+C\+C\+Address(), m\+\_\+\+Decoders, and m\+\_\+\+M\+Decoders.



Referenced by T\+B\+T\+::\+Decoder\+::$\sim$\+Decoder().



\subsection{Member Data Documentation}
\mbox{\Hypertarget{classTBT_1_1Manager_a891445980d26bff2cb101a96ffadb36d_a891445980d26bff2cb101a96ffadb36d}\label{classTBT_1_1Manager_a891445980d26bff2cb101a96ffadb36d_a891445980d26bff2cb101a96ffadb36d}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+Client\+Interfaces@{m\+\_\+\+Client\+Interfaces}}
\index{m\+\_\+\+Client\+Interfaces@{m\+\_\+\+Client\+Interfaces}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+Client\+Interfaces}{m\_ClientInterfaces}}
{\footnotesize\ttfamily vector$<$\hyperlink{classTBT_1_1ClientInterface}{Client\+Interface}$\ast$$>$ T\+B\+T\+::\+Manager\+::m\+\_\+\+Client\+Interfaces\hspace{0.3cm}{\ttfamily [private]}}



all the active clientinterfaces 



Referenced by broadcast\+Loc\+Info\+Changed(), Manager(), set\+Emergency\+Stop(), set\+Power\+State(), and $\sim$\+Manager().

\mbox{\Hypertarget{classTBT_1_1Manager_a37238f0b1b6d04d9a405f66f560c8d1a_a37238f0b1b6d04d9a405f66f560c8d1a}\label{classTBT_1_1Manager_a37238f0b1b6d04d9a405f66f560c8d1a_a37238f0b1b6d04d9a405f66f560c8d1a}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+Decoders@{m\+\_\+\+Decoders}}
\index{m\+\_\+\+Decoders@{m\+\_\+\+Decoders}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+Decoders}{m\_Decoders}}
{\footnotesize\ttfamily map$<$uint16\+\_\+t, \hyperlink{classTBT_1_1Decoder}{Decoder}$\ast$$>$ T\+B\+T\+::\+Manager\+::m\+\_\+\+Decoders\hspace{0.3cm}{\ttfamily [private]}}



all the decoders in the system, indexed by D\+CC address 



Referenced by find\+Decoder(), Manager(), register\+Decoder(), and unregister\+Decoder().

\mbox{\Hypertarget{classTBT_1_1Manager_a07202ce2904cf24a4b5127ff12d54834_a07202ce2904cf24a4b5127ff12d54834}\label{classTBT_1_1Manager_a07202ce2904cf24a4b5127ff12d54834_a07202ce2904cf24a4b5127ff12d54834}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+M\+Client\+Interfaces@{m\+\_\+\+M\+Client\+Interfaces}}
\index{m\+\_\+\+M\+Client\+Interfaces@{m\+\_\+\+M\+Client\+Interfaces}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+M\+Client\+Interfaces}{m\_MClientInterfaces}}
{\footnotesize\ttfamily recursive\+\_\+mutex T\+B\+T\+::\+Manager\+::m\+\_\+\+M\+Client\+Interfaces\hspace{0.3cm}{\ttfamily [private]}}



mutex to protect m\+\_\+\+Client\+Interfaces against concurrent access 



Referenced by broadcast\+Loc\+Info\+Changed(), set\+Emergency\+Stop(), and set\+Power\+State().

\mbox{\Hypertarget{classTBT_1_1Manager_a784fe0e0a20a0c7d0832186abe245f78_a784fe0e0a20a0c7d0832186abe245f78}\label{classTBT_1_1Manager_a784fe0e0a20a0c7d0832186abe245f78_a784fe0e0a20a0c7d0832186abe245f78}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+M\+Decoders@{m\+\_\+\+M\+Decoders}}
\index{m\+\_\+\+M\+Decoders@{m\+\_\+\+M\+Decoders}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+M\+Decoders}{m\_MDecoders}}
{\footnotesize\ttfamily recursive\+\_\+mutex T\+B\+T\+::\+Manager\+::m\+\_\+\+M\+Decoders\hspace{0.3cm}{\ttfamily [private]}}



mutex to protect m\+\_\+\+Decoders against concurrent access 



Referenced by find\+Decoder(), Manager(), register\+Decoder(), and unregister\+Decoder().

\mbox{\Hypertarget{classTBT_1_1Manager_a7d8f3b83e123244f27ed4d75421ab016_a7d8f3b83e123244f27ed4d75421ab016}\label{classTBT_1_1Manager_a7d8f3b83e123244f27ed4d75421ab016_a7d8f3b83e123244f27ed4d75421ab016}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+M\+System\+State@{m\+\_\+\+M\+System\+State}}
\index{m\+\_\+\+M\+System\+State@{m\+\_\+\+M\+System\+State}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+M\+System\+State}{m\_MSystemState}}
{\footnotesize\ttfamily recursive\+\_\+mutex T\+B\+T\+::\+Manager\+::m\+\_\+\+M\+System\+State\hspace{0.3cm}{\ttfamily [private]}}



mutex to protect m\+\_\+\+System\+State against concurrent access 



Referenced by get\+System\+State(), set\+Emergency\+Stop(), and set\+Power\+State().

\mbox{\Hypertarget{classTBT_1_1Manager_ad070372930d6b26a933f9a087666beff_ad070372930d6b26a933f9a087666beff}\label{classTBT_1_1Manager_ad070372930d6b26a933f9a087666beff_ad070372930d6b26a933f9a087666beff}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+p\+Dcc\+Generator@{m\+\_\+p\+Dcc\+Generator}}
\index{m\+\_\+p\+Dcc\+Generator@{m\+\_\+p\+Dcc\+Generator}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+p\+Dcc\+Generator}{m\_pDccGenerator}}
{\footnotesize\ttfamily \hyperlink{classTBT_1_1DccGenerator}{Dcc\+Generator}$\ast$ T\+B\+T\+::\+Manager\+::m\+\_\+p\+Dcc\+Generator\hspace{0.3cm}{\ttfamily [private]}}



pointer to the D\+CC generator 



Referenced by Manager(), and $\sim$\+Manager().

\mbox{\Hypertarget{classTBT_1_1Manager_a21b7ad1a3360959eb90df2965c1d38ea_a21b7ad1a3360959eb90df2965c1d38ea}\label{classTBT_1_1Manager_a21b7ad1a3360959eb90df2965c1d38ea_a21b7ad1a3360959eb90df2965c1d38ea}} 
\index{T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}!m\+\_\+\+System\+State@{m\+\_\+\+System\+State}}
\index{m\+\_\+\+System\+State@{m\+\_\+\+System\+State}!T\+B\+T\+::\+Manager@{T\+B\+T\+::\+Manager}}
\subsubsection{\texorpdfstring{m\+\_\+\+System\+State}{m\_SystemState}}
{\footnotesize\ttfamily \hyperlink{structTBT_1_1SystemState}{System\+State} T\+B\+T\+::\+Manager\+::m\+\_\+\+System\+State\hspace{0.3cm}{\ttfamily [private]}}



variable to hold the systemstate of the unit 



Referenced by get\+System\+State(), set\+Emergency\+Stop(), and set\+Power\+State().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{Manager_8h}{Manager.\+h}\item 
\hyperlink{Manager_8cpp}{Manager.\+cpp}\end{DoxyCompactItemize}
